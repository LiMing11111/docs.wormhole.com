# Relayers

该文档为 Wormhole 网络中的中继器提供了全面的指南，描述了它们在促进跨链过程中的作用、类型和好处。 Relayers 在 Wormhole 中是指那些负责将可验证的行动批准 ([VAA](vaa.md)) 送达目标地。它们在Wormhole的安全模型中扮演关键角色，尽管它们不能影响系统的安全性，但它们的运行状况会影响系统的响应速度（活跃性）。Relayers 作为传递机制，本身并不具备修改 VAAs 结果的能力。

主要讨论了三种类型的中继器：

* [客户端中继器](relayer.md#ke-hu-duan-zhong-ji-qi)：一种经济高效、无需后端基础设施的方法，依赖于面向用户的前端。它提供了一个简单的解决方案，尽管由于涉及手动步骤，它可能会使用户体验复杂化。
* [专用中继器](relayer.md#zhuan-yong-zhong-ji-qi)：它们是处理部分跨链流程的后端组件，可提供更流畅的用户体验，并允许进行链下计算以降低 gas 成本。这些中继器可以通过直接监听守护者网络（ Spy 式中继 ）或通过提供 REST 端点来接受要中继的 VAA（ REST 式中继 ）来运行。
* [标准中继器](relayer.md#biao-zhun-zhong-ji-qi)：一种去中心化的中继器网络，可以提供任意 VAA，从而减少开发人员开发、托管或维护中继器的需求。但是，它们要求所有计算都在链上完成，并且可能不太节省 gas。

## 客户端中继器

客户端中继依赖于面向用户的前端，如网页或钱包，来完成完整的跨链过程。

### 主要特性

1. **成本效益**：用户只需支付第二笔交易的交易费，无需支付任何额外费用。
2. **无后端基础设施**：该过程完全基于客户端，无需后端中继基础设施。

### 实现

用户自己进行跨链过程的三个步骤：

1. 对链 A 执行操作。
2. 从 Guardian Network 检索生成的 VAA。
3. 使用 VAA 对链 B 执行操作。

### 注意事项

\{% 提示 style="info" %\} 虽然简单，但如果您的目标是提供高度精致的用户体验，通常不建议使用这种中继方式。不过，对于启动和运行最小可行产品 (MVP) 来说，这种方法很有用。 \{% 结束提示 %\}

* 用户必须使用自己的钱包签署所有必要的交易。
* 用户必须拥有资金来支付所涉及的每条链的交易费用。
* 由于涉及手动步骤，用户体验可能会很麻烦。

## 专用中继器

专门化中继器是Wormhole协议内的定制组件，设计用于为特定应用传递消息。它们能够执行链下计算，并可以根据各种使用情况进行定制。

### 主要特性

1. **优化：** 能够执行不受信任的链下计算，从而优化气体成本。
2. **可定制性：** 允许采取诸如批处理、条件交付、多链交付等特定策略。
3. **激励结构：** 开发者有自由设计适合其应用程序的激励结构。
4. **增强用户体验：** 能够代替用户执行跨链过程的第 2 步和第 3 步从而可以简化用户体验。

### 实现

{% hint style="info" %}
为了使专用中继器的开发更加容易，[主 Wormhole 仓库](https://github.com/wormhole-foundation/wormhole/tree/main/relayer)中提供了一个插件中继器。这将建立起基本的中继基础设施，允许开发者专注于实现他们应用程序的特定逻辑。
{% endhint %}

设置专用中继器有两种主要方法：

* \*\*Spy 式中继：\*\*通过间谍直接监听 Guardian Network。
* \*\*REST 式中继：\*\*提供一个 REST 端点来接受应该被转播的 VAA。

### 考虑因素

{% hint style="info" %}
请记住，尽管它们的名字是“专用”，但是这些特殊化的中继器仍然被视为不可信任。 VAA是公开的，并且可以由任何人提交，所以开发者不应依赖链下中继器执行任何被认为是“可信”的计算。
{% endhint %}

* 需要进行开发工作和托管服务。
* 费用模型可能会变得复杂，因为负责支付目标链费用的是中继器。
* 中继器负责活跃性检测，在跨链应用程序上增加了额外依赖项。

## 标准中继器

标准中继器是 Wormhole 协议中去中心化网络的组成部分，有助于将可验证操作批准 (VAA) 传送给与标准中继器 API 兼容的接收者合约。

### 主要特征

1. **降低运营成本**：无需开发、托管或维护单独的中继器。
2. **简化集成**：由于不需要运行中继器，因此集成就像调用函数和实现接口一样简单。

### 实现

标准中继器集成涉及两个关键步骤：

1. **交付请求**：向 Wormhole 中继生态系统合约请求交付。
2. **中继接收**：在合约中实现 [receiveWormholeMessages](https://github.com/wormhole-foundation/wormhole-solidity-sdk/blob/bacbe82e6ae3f7f5ec7cdcd7d480f1e528471bbb/src/interfaces/IWormholeReceiver.sol#L44-L50) 函数。VAA 中继成功后将调用此函数。

### 注意事项

\{% 提示 style="info" %\} 开发人员应注意，中继器的选择取决于项目的具体要求和限制。标准中继器提供了简单性和便利性，但与专用中继器相比，可能会限制定制和优化机会。 \{% 结束提示 %\}

* 所有计算都在链上进行。
* 与专门的中继器相比，其 gas 效率可能较低。
* 条件交付、批处理、链下计算等优化功能可能会受到限制。
* 可能并非所有链都提供支持。

### 基础知识

本节重点介绍了 Wormhole 网络内中继器运行和处理的关键原则。 中继器在网络中基本上是不受信任的实体。这意味着，虽然它们不需要您的信任，但不应被完全信任。它们作为传递机制，将可验证操作批准 (VAA) 从其来源传输到其目的地。

VAA 的主要特征包括：

* 来自守护者网络的公开发布
* 通过守护者网络的签名进行身份验证
* 任何实体或任何 Wormhole 核心合约的可验证性
* 由于这些特点，任何人都可以获取 VAA 并将其传送到任何地方，但没有人可以在不使签名无效的情况下更改 VAA 内容。

在设计合约时，务必仅信任合约或 VAA 中包含的信息。依赖中继器的信息可能会使您遭受不受信任的输入攻击。

高级策略可能涉及让中继器执行不受信任的链下计算，并将其传递到目标合约中。这些策略可以优化 gas 成本，但如果使用不当，也可能产生攻击媒介。

总之，中继器的设计应确保有一种单一、确定的方式来处理协议中的消息。在优化设计的协议中，中继器应该有一个“正确”的实现，以反映区块链其他地方使用的“ crank turner ”流程。
